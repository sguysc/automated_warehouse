function [x, V] = LoadMotionPrimitives(mp_data, action, index, orientation)
%     %jackal gazebo 
%     switch action
%         case 0
%             x = [0., 0., 0.; 2.37619045e-01, -3.51585332e-14, -3.55108234e-13; ...
%                 7.12857136e-01, -2.70073646e-13, -2.40052265e-13; ...
%                 1.18809523e+00, -1.08548765e-13,  8.52032261e-13; ...
%                 1.66333332e+00,  1.55275769e-13, -4.83005296e-13; ...
%                 2.13857141e+00, -7.41066175e-13, -2.91285649e-12; ...
%                 2.61380950e+00, -2.72302867e-12, -6.03522620e-12; ...
%                 3.08904759e+00, -6.95817150e-12, -1.21924951e-11; ...
%                 3.56428568e+00, -1.39132301e-11, -1.58343421e-11; ...
%                 4.03952377e+00, -2.16268716e-11, -1.70681440e-11; ...
%                 4.51476186e+00, -3.00134255e-11, -1.75275826e-11; ...
%                 4.99000000e+00, -3.83455635e-11, -1.83603635e-11];
%             V = [ 1.27999998e+00, -1.22043602e-13, -8.23932486e-15, -1.22043602e-13,  1.27999974e+00,  1.31848561e-10, -8.23932486e-15,  1.31848561e-10,  2.67682593e-08; ... 
%                   3.71244610e+00, -4.69069522e-07, -6.22246131e-07, -4.69069522e-07,  1.05406061e+01,  1.45891896e+00,       -6.22246131e-07,  1.45891896e+00,  6.40031764e-01; ...
%                   3.77853339e+00, 1.43087091e-06, 1.36724518e-06,1.43087091e-06, 1.06840437e+01, 1.46876254e+00,        1.36724518e-06, 1.46876254e+00, 6.21876972e-01; ... 
%                   3.84310087e+00, 8.91766213e-07, 8.51621762e-07, 8.91766213e-07, 1.08755891e+01, 1.50535328e+00, 8.51621762e-07, 1.50535328e+00, 6.11120209e-01; ...
%                   3.91063413e+00, -2.11224578e-07, -2.02316587e-07, -2.11224578e-07,  1.10648661e+01,  1.53586087e+00, -2.02316587e-07,  1.53586087e+00,  6.28918388e-01; ...
%                   3.97771407e+00, -2.50241036e-06, -2.39243789e-06, -2.50241036e-06,  1.12585068e+01,  1.56710212e+00, -2.39243789e-06,  1.56710212e+00,  6.30358695e-01; ...
%                   4.04700420e+00, -1.83546003e-06, -1.75801149e-06, -1.83546003e-06,  1.14585435e+01,  1.59888151e+00, -1.75801149e-06,  1.59888151e+00,  6.30834119e-01; ... 
%                   4.11809130e+00, 2.17941397e-06, 2.09561506e-06, 2.17941397e-06, 1.16618603e+01, 1.63069814e+00, 2.09561506e-06, 1.63069814e+00, 6.39442369e-01; ... 
%                   4.19159544e+00, 1.32277544e-06, 1.27332568e-06, 1.32277544e-06, 1.18704250e+01, 1.66343374e+00, 1.27332568e-06, 1.66343374e+00, 6.46204839e-01; ... 
%                   4.26533660e+00, -1.04179113e-10, -1.96804850e-10, -1.04179113e-10,  1.20833351e+01,  1.69486161e+00, -1.96804850e-10,  1.69486161e+00,  6.32801775e-01; ... 
%                   4.34219350e+00, 3.29506552e-10, 2.08648011e-10, 3.29506552e-10, 1.23004498e+01, 1.72597280e+00, 2.08648011e-10, 1.72597280e+00, 6.66013431e-01; ... 
%                   4.41179116e+00, 1.50640759e-10, 3.66807432e-11, 1.50640759e-10, 1.24902900e+01, 1.73703927e+00, 3.66807432e-11, 1.73703927e+00, 7.11520961e-01];
%         case 1
%             x = [0., 0., 0.; 1.91538460e-01, 5.93825959e-14, 7.44071089e-13; 5.74615379e-01, 6.17147294e-13, 1.76378802e-12; 9.57692298e-01, 1.22870552e-12, 1.35812508e-12; 1.34076922e+00, 2.03211562e-12, 3.88478902e-12; 1.72384614e+00, 3.91739857e-12, 4.15874905e-12;  2.10692306e+00,  4.47685813e-12, -1.37421112e-12;  2.49000000e+00,  3.20637013e-12, -4.23019968e-12];
% 
%             V = [ 1.27999821e+00, -1.72098035e-14,  1.63607785e-14,-1.72098035e-14,  1.28000143e+00,  1.88825380e-10,1.63607785e-14,  1.88825380e-10,  3.87205640e-08; ...
%                    3.79132247e+00, 3.37724044e-08, 3.21284484e-08,3.37724044e-08, 1.06878263e+01, 1.43115142e+00,3.21284484e-08, 1.43115142e+00, 6.64834599e-01; ... 
%                    3.86556123e+00, -3.34641663e-08, -3.23182681e-08,-3.34641663e-08,  1.09100139e+01,  1.45554524e+00,-3.23182681e-08,  1.45554524e+00,  6.66540022e-01; ...
%                    3.93437662e+00, 1.16413789e-09, 1.11669259e-09,1.16413789e-09, 1.11007290e+01, 1.50014673e+00,       1.11669259e-09, 1.50014673e+00, 6.84948257e-01; ... 
%                    4.00681335e+00, -6.08439948e-11, -3.04099060e-11,       -6.08439948e-11,  1.13150875e+01,  1.53300045e+00,       -3.04099060e-11,  1.53300045e+00,  6.90468347e-01; ...
%                    4.07847102e+00, 4.11949721e-11, 4.38166261e-11,       4.11949721e-11, 1.15155032e+01, 1.56477676e+00,       4.38166261e-11, 1.56477676e+00, 7.06573112e-01; ... 
%                    4.15202918e+00, -2.41395209e-10, -2.51340225e-10,       -2.41395209e-10,  1.17278610e+01,  1.59736412e+00,       -2.51340225e-10,  1.59736412e+00,  7.12321615e-01; ...
%                    4.22687651e+00, 3.23356800e-11, 6.93206562e-12,       3.23356800e-11, 1.19455635e+01, 1.62983062e+00,       6.93206562e-12, 1.62983062e+00, 7.00842702e-01];
%         case 2
%             x = [0., 0., 0.; 2.47999998e-01, 7.00045662e-15, 6.77463551e-14; 7.43999993e-01, 1.79489160e-13, 8.06166218e-13; 1.24000000e+00, 7.14046550e-13, 9.84077284e-13];
% 
%             V = [ 1.27999849e+00, -8.08491510e-14,  3.23475533e-14,        -8.08491510e-14,  1.28000132e+00,  1.00308383e-10,        3.23475533e-14,  1.00308383e-10,  2.04374120e-08; ...
%                 4.35984810e+00, -6.30998425e-12, -5.86681119e-12,        -6.30998425e-12,  1.23032541e+01,  1.59970694e+00,       -5.86681119e-12,  1.59970694e+00,  8.68287409e-01; ... 
%                 4.46180047e+00, -9.49741206e-12, -2.77684245e-12,        -9.49741206e-12,  1.25605471e+01,  1.63249594e+00,       -2.77684245e-12,  1.63249594e+00,  8.66485259e-01; ...
%                 4.56160264e+00, -7.34862895e-12, -3.59414367e-13,       -7.34862895e-12,  1.28479868e+01,  1.68839454e+00,        -3.59414367e-13,  1.68839454e+00,  8.72903655e-01];
%         case 3
%             x = [0., 0., 0.; 0.36200994, 0.01513758, 0.10054799; 1.06528671, 0.18418906, 0.35521204; 1.72300291, 0.48855978, 0.48649947; 2.36243501, 0.83077613, 0.4731381; 3.02809437, 1.11668766, 0.31207205; 3.74, 1.24, 0.01];
% 
%             V = [ 1.28001280e+00, -8.65936553e-12, -1.05120388e-11,       -8.65936553e-12,  1.27998695e+00,  2.47654769e-11,       -1.05120388e-11,  2.47654769e-11,  1.79930836e-08; ...
%                 2.78585866, -0.95885278, -0.31841373,        -0.95885278,  6.84833715,  0.96582436,        -0.31841373,  0.96582436,  0.31769594; ...
%                 3.36310863, -1.74815139, -0.49138448, -1.74815139,  6.43186072,  0.92065437, -0.49138448,  0.92065437,  0.321864; ...
%                 3.63602   , -1.96004022, -0.51782738, -1.96004022,  6.25411574,  0.93417461, -0.51782738,  0.93417461,  0.30171589; ...
%                 3.38918226, -1.72563359, -0.39896379, -1.72563359,  6.54737564,  0.9987184, -0.39896379,  0.9987184 ,  0.26641669; ...
%                 2.91247772, -0.92310828, -0.12464666, -0.92310828,  7.3061067 ,  1.08831767, -0.12464666,  1.08831767,  0.27250968; ...
%                 2.76233788, 0.06181424, 0.16290094,       0.06181424, 7.64377155, 1.07353168,        0.16290094, 1.07353168, 0.26622454];
%         case 4
%             x = [0., 0., 0.;  0.30766413, -0.00836661, -0.07108639;  1.01605875, -0.15973948, -0.33360082;  1.68979473, -0.46197916, -0.48612431;  2.33936687, -0.81511559, -0.48309246;  3.01523207, -1.11188489, -0.31765605;  3.74, -1.24, -0.01];
% 
%             V = [1.27995033e+00,  7.99856090e-12, -6.91155616e-12, 7.99856090e-12,  1.28004808e+00, -4.98443664e-11, -6.91155616e-12, -4.98443664e-11,  1.19694540e-07; ...
%                 2.80079998, 0.91789501, 0.31687475,       0.91789501, 7.44072739, 1.06139102,       0.31687475, 1.06139102, 0.46552353; ...
%                 3.31071311, 1.61000031, 0.46529173,       1.61000031, 6.5413877 , 0.9443159 ,       0.46529173, 0.9443159 , 0.31506541; ...
%                 3.57561063, 1.9044089 , 0.50462034,        1.9044089 , 6.37457402, 0.94937265,      0.50462034, 0.94937265, 0.30338635; ...
%                 3.40810651, 1.66769357, 0.38639734,        1.66769357, 6.6160889 , 1.00437511,       0.38639734, 1.00437511, 0.25829637; ...
%                 3.08498375, 0.99908639, 0.1436872 ,       0.99908639, 7.48515008, 1.11163269,       0.1436872 , 1.11163269, 0.27120803; ...
%                 2.86119251, -0.06458955, -0.16949718,        -0.06458955,  7.91503619,  1.11112127,       -0.16949718,  1.11112127,  0.2816985 ];
%         case 5
%             x = [0., 0., 0.; 0.55889647, 0.04187186, 0.18013494; 1.56441534, 0.51643355, 0.6908927 ; 2.24083795, 1.40258863, 1.13533273; 2.49      , 2.49      , 1.56079633];
% 
%             V = [ 1.27994532e+00, -1.19218174e-12, -6.96641111e-12, -1.19218174e-12,  1.28005412e+00, -3.12193924e-13, -6.96641111e-12, -3.12193924e-13,  4.30482740e-08; ...
%                 3.03952922, -1.31517508, -0.42886026, -1.31517508,  6.43136671,  0.89881442, -0.42886026,  0.89881442,  0.30250026; ...
%                 4.97548007, -2.20147067, -0.81555777, -2.20147067,  4.64394586,  0.61557247, -0.81555777,  0.61557247,  0.29795258; ...
%                 6.7194477 , -1.34972742, -1.02507451, -1.34972742,  3.0638553 ,  0.23902095, -1.02507451,  0.23902095,  0.25692916; ...
%                 8.12587044,  0.04241956, -1.16197351, 0.04241956,  2.90858265, -0.13649682, -1.16197351, -0.13649682,  0.30224664];
%         case 6
%             x = [0., 0., 0.;  0.55889647, -0.04187186, -0.18013494;  1.56441534, -0.51643355, -0.6908927 ;  2.24083795, -1.40258863, -1.13533273;  2.49      , -2.49      , -1.56079633];
% 
%             V = [ 1.27994538e+00,  1.00584453e-12,  7.18838819e-12, 1.00584453e-12,  1.28005406e+00, -2.92955888e-13, 7.18838819e-12, -2.92955888e-13,  4.32862480e-08; ...
%                 3.03952943, 1.31517537, 0.42886144, 1.31517537, 6.43136746, 0.89881688, 0.42886144, 0.89881688, 0.30246696; ...
%                 4.97547967, 2.2014705 , 0.81555769, 2.2014705 , 4.64394549, 0.61557239, 0.81555769, 0.61557239, 0.29794486; ...
%                 6.71944715, 1.34972729, 1.02507456, 1.34972729, 3.06385504, 0.23902147, 1.02507456, 0.23902147, 0.25692846; ...
%                 8.12583839, -0.04241939,  1.16196858, -0.04241939,  2.90857118, -0.13649649, 1.16196858, -0.13649649,  0.30224002];
%         case 7
%             x = [0., 0., 0.; 0.44926102, 0.04462528, 0.23986123; 1.16998111, 0.55831009, 1.01390314; 1.31601924, 1.43181689, 1.77756312; 0.84821135, 2.18874113, 2.46336313; 0.01      , 2.49      , 3.13159265];
% 
%             V = [ 1.28021950e+00,  5.15195591e-11,  1.93900560e-10,        5.15195591e-11,  1.27977882e+00, -1.91974446e-10,        1.93900560e-10, -1.91974446e-10,  1.23831581e-07; ... 
%                 3.36697095, -1.45514607, -0.54143894,       -1.45514607,  5.35220338,  0.67717916,       -0.54143894,  0.67717916,  0.24318409; ... 
%                 5.90721502, -0.99152802, -0.86577129,       -0.99152802,  2.93487214,  0.08372477,       -0.86577129,  0.08372477,  0.22804139; ... 
%                 5.69947313,  1.45281459, -0.74073415,        1.45281459,  3.31378764, -0.52768163,       -0.74073415, -0.52768163,  0.23101526; ... 
%                 3.41136399,  1.58766858, -0.27446812,        1.58766858,  5.88318075, -0.9168143 ,       -0.27446812, -0.9168143 ,  0.22160281; ... 
%                 5.11554961, -0.17634031,  0.38333667,       -0.17634031, 13.62125583, -1.58183621,        0.38333667, -1.58183621,  0.6816334 ];
%         case 8
%             x = [0., 0., 0.;  0.44926102, -0.04462528, -0.23986123;  1.16998111, -0.55831009, -1.01390314;  1.31601924, -1.43181689, -1.77756312;  0.84821135, -2.18874113, -2.46336313;  0.01      , -2.49      , -3.13159265];
% 
%             V = [ 1.28027442e+00, -1.94107513e-10, -5.36809044e-10, -1.94107513e-10,  1.27972390e+00, -5.15004075e-10,-5.36809044e-10, -5.15004075e-10,  1.24357920e-07; ...
%                 3.39010211, 1.46514205, 0.54513318, 1.46514205, 5.38897165, 0.68180231, 0.54513318, 0.68180231, 0.24487931; ... 
%                 5.94824896, 0.99841904, 0.87204556, 0.99841904, 2.95525475, 0.08432263, 0.87204556, 0.08432263, 0.22758151; ... 
%                 5.73943147, -1.46299806,  0.74610171, -1.46299806,  3.33702272, -0.53140085, 0.74610171, -0.53140085,  0.23476754; ...
%                 3.4355314 , -1.59891626,  0.27640934, -1.59891626,  5.92485938, -0.92330252, 0.27640934, -0.92330252,  0.22324032; ... 
%                 6.19935894,  0.21365018, -0.46042254, 0.21365018, 16.49640426, -1.93831294, -0.46042254, -1.93831294,  0.86503763];
%     end
   
    mp = mp_data.mp.(['x' num2str(action)]);
    if index > size(mp)
        x = nan;
        V = nan;
        return
    end
    x = mp(index).x;
    V = reshape( mp(index).V ,3,3);
    %V = reshape( V(index, :) ,3,3);
    %x = x(index,:)';
    
    R = GetRotmat(orientation);
    Rinv = inv(R);
    
    x = R * x;
    V = Rinv' * V * Rinv;
%     V = R' * V * R;

end

function rotmat = GetRotmat(orient)
    if(orient == 0)
        rotmat = [1.,0. 0; 0.,1. 0; 0, 0, 1];
    elseif(orient == 1)
        rotmat = [0.,-1., 0; 1.,0. 0; 0, 0, 1];
    elseif(orient == 2)
        rotmat = [-1.,0., 0; 0.,-1. 0; 0, 0, 1];
    elseif((orient == 3) || (orient == -1))
        rotmat = [0.,1., 0; -1.,0. 0; 0, 0, 1];
    else
        disp('bad orientation parameter')
        rotmat = eye(3);
    end
end