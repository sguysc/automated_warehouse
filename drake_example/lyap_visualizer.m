%%
function lyap_visualizer()
close all
clc

rho = 23.87657654615014;


% V0 = ((x .* (2.6555498930974717 .* x - 0.15522456058359552 .* y + 0.20970467915030144 .* z)) + (y .* ( - 0.15522456058359482 .* x + 5.9754720562311601 .* y + 0.86794890153762561 .* z)) + (z .* (0.20970467915030144 .* x + 0.8679489015376245 .* y + 0.9795182590467979 .* z)));
% V1 = ((( - 4.4536165793262299 .* x - 25.144566326822531 .* y - 28.507770162429285 .* z + ((-938.8783990250738 .* (z.^3)) ./ 6) + 2 .* ((-829.56721330938967 .* y .* (z.^2)) ./ 6) + ((-829.56721330938956 .* y .* (z.^2)) ./ 6) + 3 .* ((-732.97685985381588 .* (y.^2) .* z) ./ 6) + ((-647.62764880822363 .* (y.^3)) ./ 6) + 3 .* ((-167.31986444473347 .* x .* (z.^2)) ./ 6) + 6 .* ((-147.75418754547343 .* x .* y .* z) ./ 6) + 2 .* ((-130.4748984149104 .* x .* (y.^2)) ./ 6) + ((-130.47489841491034 .* x .* (y.^2)) ./ 6) + ((-103.16623075935155 .* (z.^2)) ./ 2) + 2 .* ((-90.729785421060896 .* y .* z) ./ 2) + ((-79.787968273352078 .* (y.^2)) ./ 2) + 3 .* ((-28.609997669819307 .* (x.^2) .* z) ./ 6) + 3 .* ((-25.242589732921175 .* (x.^2) .* y) ./ 6) + 2 .* ((-12.34616652908074 .* x .* z) ./ 2) + ((-10.793135167763129 .* x .* y) ./ 2) + ((-10.793135167763127 .* x .* y) ./ 2) + ((-4.5812074415868249 .* (x.^3)) ./ 6) + ((-0.55781373744848395 .* (x.^2)) ./ 2)) .* (0.41940935830060289 .* x + 1.7358978030752501 .* y + 1.9590365180935958 .* z)) + (( - 2.3690853607440503 .* x + 0.57239347221291415 .* y + 0.11397416505168623 .* z + ((-7.4918254688016912 .* (z.^2)) ./ 2) + ((-1.8111314757560719 .* (z.^3)) ./ 6) + 3 .* ((-0.57239347221291415 .* y .* (z.^2)) ./ 6) + 2 .* ((-0.057430911338335174 .* y .* z) ./ 2) + 2 .* ((0.23770140281269553 .* x .* z) ./ 2) + 3 .* ((2.3690853607440503 .* x .* (z.^2)) ./ 6)) .* (5.3110997861949434 .* x - 0.31044912116719037 .* y + 0.41940935830060289 .* z)) + (( - 0.31044912116719037 .* x + 11.95094411246232 .* y + 1.7358978030752501 .* z) .* ( - 0.23770140281269553 .* x + 0.057430911338335174 .* y + 7.4066836076782163 .* z + ((-7.5769673299251661 .* (z.^3)) ./ 6) + 2 .* ((-2.3690853607440503 .* x .* z) ./ 2) + 3 .* ((-0.057430911338335174 .* y .* (z.^2)) ./ 6) + 3 .* ((0.23770140281269553 .* x .* (z.^2)) ./ 6) + 2 .* ((0.57239347221291415 .* y .* z) ./ 2) + ((0.96255282040387902 .* (z.^2)) ./ 2))));

%V2 = ((x .* (81194.236418103916 .* x - 8759.6809362783388 .* y + 92.101655530561658 .* z)) + (y .* ( - 8759.6809362783461 .* x + 169637.86011662724 .* y + 2071.691387096972 .* z)) + (z .* (92.101655530559398 .* x + 2071.691387096972 .* y + 2077.3493014264536 .* z)));
% V2 = (0.0001 - 0.0027944441292675395 .* x - 0.0011837837257599206 .* y + 0.73156072296019781 .* (x .* y) + 6.6496298154162705 .* (x.^2) + 0.64076773138885923 .* (y.^2));
% V3 = ((y .* (-0.0027944441292675395 + 13.299259630832541 .* x + 0.73156072296019781 .* y)) + ((-0.0011837837257599206 + 0.73156072296019781 .* x + 1.2815354627777185 .* y) .* ( - 10.295630140987015 .* x - 6.8265115748802545 .* y + ((-10 .* (x.^3)) ./ 6) + ((1.2246467991473533e-15 .* (x.^2)) ./ 2))));
% Vdot = (((-0.0014450715325206485 + 0.00091396388141257699 .* x - 0.00083576985736497848 .* y - 4.4346256000659653e-07 .* y) .* (-2.2204460492503131e-16 - 2.8115338151280138 .* (-3.1000000000000001 + x) + 0.12467524917432853 .* (-1.8999999999999999 + y) + 0.29062218214616281 .* (-0.10000000000000003 + y) + ((-1.2312513831192315 .* ((-0.10000000000000003 + y).^2)) / 2) + ((-1.1025926649111579 .* ((-0.10000000000000003 + y).^3)) / 6) + 3 .* ((-0.12467524917432853 .* (-1.8999999999999999 + y) .* ((-0.10000000000000003 + y).^2)) / 6) + 2 .* ((-0.012509250243078097 .* (-1.8999999999999999 + y) .* (-0.10000000000000003 + y)) / 2) + 2 .* ((0.28209432339802509 .* (-3.1000000000000001 + x) .* (-0.10000000000000003 + y)) / 2) + 3 .* ((2.8115338151280138 .* (-3.1000000000000001 + x) .* ((-0.10000000000000003 + y).^2)) / 6))) + ((-0.0011955216344130524 - 0.00083576985736497848 .* x + 0.0016758017876373453 .* y + 0.00018489181467413156 .* y) .* (-5.5511151231257827e-17 - 0.28209432339802509 .* (-3.1000000000000001 + x) + 0.012509250243078097 .* (-1.8999999999999999 + y) + 1.1905169870535861 .* (-0.10000000000000003 + y) + 2 .* ((-2.8115338151280138 .* (-3.1000000000000001 + x) .* (-0.10000000000000003 + y)) / 2) + ((-1.2719857791848768 .* ((-0.10000000000000003 + y).^3)) / 6) + 3 .* ((-0.012509250243078097 .* (-1.8999999999999999 + y) .* ((-0.10000000000000003 + y).^2)) / 6) + 2 .* ((0.12467524917432853 .* (-1.8999999999999999 + y) .* (-0.10000000000000003 + y)) / 2) + 3 .* ((0.28209432339802509 .* (-3.1000000000000001 + x) .* ((-0.10000000000000003 + y).^2)) / 6) + ((0.69660742352866034 .* ((-0.10000000000000003 + y).^2)) / 2))) + ((-0.00051260060467727005 - 4.4346256000659653e-07 .* x + 0.00018489181467413156 .* y + 0.00040366192658917305 .* y) .* (-9.7699626167013776e-15 + 11.223240929675072 .* (-3.1000000000000001 + x) - 108.9957386471317 .* (-1.8999999999999999 + y) - 110.72125700558496 .* (-0.10000000000000003 + y) + ((-172832.12257904885 .* ((-0.10000000000000003 + y).^3)) / 6) + ((-171787.77838502754 .* (-1.8999999999999999 + y) .* ((-0.10000000000000003 + y).^2)) / 6) + ((-171787.77838502752 .* (-1.8999999999999999 + y) .* ((-0.10000000000000003 + y).^2)) / 6) + ((-171787.77838502749 .* (-1.8999999999999999 + y) .* ((-0.10000000000000003 + y).^2)) / 6) + ((-170745.56775913894 .* ((-1.8999999999999999 + y).^2) .* (-0.10000000000000003 + y)) / 6) + 2 .* ((-170745.56775913891 .* ((-1.8999999999999999 + y).^2) .* (-0.10000000000000003 + y)) / 6) + ((-169705.48721974602 .* ((-1.8999999999999999 + y).^3)) / 6) + ((-3554.9398598703192 .* ((-0.10000000000000003 + y).^2)) / 2) + 2 .* ((-3524.4550619080669 .* (-1.8999999999999999 + y) .* (-0.10000000000000003 + y)) / 2) + ((-3494.0344345019516 .* ((-1.8999999999999999 + y).^2)) / 2) + ((16.659002608308189 .* ((-3.1000000000000001 + x).^2)) / 2) + ((35.363810762918718 .* ((-3.1000000000000001 + x).^3)) / 6) + 2 .* ((109.31752394940582 .* (-3.1000000000000001 + x) .* (-0.10000000000000003 + y)) / 2) + ((110.3672990652795 .* (-3.1000000000000001 + x) .* (-1.8999999999999999 + y)) / 2) + ((110.36729906527951 .* (-3.1000000000000001 + x) .* (-1.8999999999999999 + y)) / 2) + 2 .* ((419.22463058230051 .* ((-3.1000000000000001 + x).^2) .* (-0.10000000000000003 + y)) / 6) + ((419.22463058230062 .* ((-3.1000000000000001 + x).^2) .* (-0.10000000000000003 + y)) / 6) + 3 .* ((420.41937577287842 .* ((-3.1000000000000001 + x).^2) .* (-1.8999999999999999 + y)) / 6) + 2 .* ((904.53307719747136 .* (-3.1000000000000001 + x) .* ((-0.10000000000000003 + y).^2)) / 6) + ((904.53307719747283 .* (-3.1000000000000001 + x) .* ((-0.10000000000000003 + y).^2)) / 6) + 4 .* ((941.14875949940506 .* (-3.1000000000000001 + x) .* (-1.8999999999999999 + y) .* (-0.10000000000000003 + y)) / 6) + 2 .* ((941.14875949940529 .* (-3.1000000000000001 + x) .* (-1.8999999999999999 + y) .* (-0.10000000000000003 + y)) / 6) + 2 .* ((977.68079947830392 .* (-3.1000000000000001 + x) .* ((-1.8999999999999999 + y).^2)) / 6) + ((977.68079947830552 .* (-3.1000000000000001 + x) .* ((-1.8999999999999999 + y).^2)) / 6))));
%
%fig=figure;hold all;
h=uicontrol('style','slider',...
    'units','normalized',...
    'callback',@slider1_Callback,'min',-pi,'max',pi);
get_lyap(0.0);
% surf(x,y,V2);


end

function [v, vdot] = get_lyap(theta)
%     theta = str2num(theta);
    [x, y] = meshgrid(-5:0.1:5, -5:0.1:5);
    z = ones(size(x))*theta;
    
    v = ((x .* (2.4761971377445624 .* x + 0.016960386112716913 .* y - 0.015871843903240083 .* z)) + (y .* (0.016960386112716663 .* x + 5.3099825874334394 .* y + 0.11924257432148347 .* z)) + (z .* ( - 0.01587184390324017 .* x + 0.11924257432148347 .* y + 0.12181527082021557 .* z)));
    vdot = ((( - 2.4279535792537388 .* x - 0.32317400419696934 .* y - 0.28154472240580802 .* z + ((-6.8524257429168998 .* (z.^2)) ./ 2) + 2 .* ((-0.024280345142771456 .* x .* z) ./ 2) + 2 .* ((-0.003231847770946959 .* y .* z) ./ 2) + 3 .* ((0.32317400419696934 .* y .* (z.^2)) ./ 6) + ((0.98154724070477528 .* (z.^3)) ./ 6) + 3 .* ((2.4279535792537388 .* x .* (z.^2)) ./ 6)) .* (4.9523942754891248 .* x + 0.033920772225433576 .* y - 0.03174368780648025 .* z)) + (( - 0.03174368780648025 .* x + 0.23848514864296694 .* y + 0.24363054164043113 .* z) .* (0.91271887368125215 .* x - 15.015721542416053 .* y - 15.34841636363589 .* z + ((-580.237426195495 .* (z.^3)) ./ 6) + ((-567.80600656075569 .* y .* (z.^2)) ./ 6) + 2 .* ((-567.80600656075558 .* y .* (z.^2)) ./ 6) + 3 .* ((-555.64087251233912 .* (y.^2) .* z) ./ 6) + ((-543.73632123908328 .* (y.^3)) ./ 6) + 2 .* ((-3.9800194166342706 .* (x.^2) .* z) ./ 6) + ((-3.9800194166342684 .* (x.^2) .* z) ./ 6) + ((-3.8929578264391846 .* (x.^2) .* y) ./ 6) + 2 .* ((-3.8929578264391838 .* (x.^2) .* y) ./ 6) + ((-2.8350338148389311 .* x .* z) ./ 2) + ((-2.8350338148389307 .* x .* z) ./ 2) + 2 .* ((-2.7695379677874152 .* x .* y) ./ 2) + ((-0.34599013341043067 .* (x.^2)) ./ 2) + ((0.13613066991939973 .* (x.^3)) ./ 6) + ((50.810729283213504 .* x .* (y.^2)) ./ 6) + ((50.810729283213512 .* x .* (y.^2)) ./ 6) + ((50.810729283213526 .* x .* (y.^2)) ./ 6) + ((51.930049742267187 .* x .* y .* z) ./ 6) + 3 .* ((51.930049742267194 .* x .* y .* z) ./ 6) + ((51.930049742267201 .* x .* y .* z) ./ 6) + ((51.930049742267208 .* x .* y .* z) ./ 6) + ((53.074017483793618 .* x .* (z.^2)) ./ 6) + 2 .* ((53.074017483793632 .* x .* (z.^2)) ./ 6) + ((61.142797557735662 .* (y.^2)) ./ 2) + 2 .* ((62.505112968407587 .* y .* z) ./ 2) + ((63.897751528899839 .* (z.^2)) ./ 2))) + ((0.024280345142771456 .* x + 0.003231847770946959 .* y + 6.8489256136536518 .* z + ((-6.8559258721801486 .* (z.^3)) ./ 6) + 2 .* ((-2.4279535792537388 .* x .* z) ./ 2) + ((-0.63154598155529174 .* (z.^2)) ./ 2) + 2 .* ((-0.32317400419696934 .* y .* z) ./ 2) + 3 .* ((-0.024280345142771456 .* x .* (z.^2)) ./ 6) + 3 .* ((-0.003231847770946959 .* y .* (z.^2)) ./ 6)) .* (0.033920772225433576 .* x + 10.619965174866879 .* y + 0.23848514864296694 .* z)));
    
    surf(x,y,v); hold on
    surf(x,y,vdot); hold off
    axis([-pi pi -5 5 -10 10]);
%     zoom on
    title(['\theta=' num2str(theta)])
end

function slider1_Callback(hObject, eventdata, handles)
% hObject    handle to slider1 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'Value') returns position of slider
%        get(hObject,'Min') and get(hObject,'Max') to determine...
slider_value = get(hObject,'Value');
get_lyap(slider_value);
end
% pause
% clf
% surf(x,y,V2);
% surf(x,y,V3);
% surf(x,y,Vdot);

% axis([-pi pi -5 5 -1 12])